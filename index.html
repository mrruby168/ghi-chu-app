<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#007bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Ghi Ch√∫">
    <meta name="description" content="·ª®ng d·ª•ng ghi ch√∫ ƒë∆°n gi·∫£n">
    
    <title>Ghi Ch√∫</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            height: 100%;
            overflow: hidden;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .app {
            display: flex;
            flex-direction: column;
            height: 100%;
            max-width: 500px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        
        /* ===== HEADER ===== */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            background: #fff;
            border-bottom: 1px solid #e8e8e8;
            flex-shrink: 0;
        }
        
        header h1 {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
        }
        
        .header-btns {
            display: flex;
            gap: 8px;
        }
        
        .icon-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            border-radius: 10px;
            font-size: 1.3rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .icon-btn:active {
            background: #f0f0f0;
        }
        
        /* ===== SEARCH ===== */
        .search-bar {
            padding: 12px 16px;
            background: #fff;
            flex-shrink: 0;
        }
        
        .search-input {
            width: 100%;
            height: 44px;
            padding: 0 16px;
            background: #f5f5f5;
            border: 2px solid transparent;
            border-radius: 12px;
            font-size: 1rem;
            color: #333;
            transition: border-color 0.2s, background 0.2s;
        }
        
        .search-input:focus {
            outline: none;
            background: #fff;
            border-color: #007bff;
        }
        
        .search-input::placeholder {
            color: #999;
        }
        
        /* ===== NOTES LIST ===== */
        .notes-wrapper {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .notes-list {
            padding: 8px 16px 120px 16px;
        }
        
        .note-card {
            background: #fff;
            border-radius: 14px;
            padding: 16px 18px;
            margin-bottom: 12px;
            border-left: 4px solid #007bff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            cursor: pointer;
            transition: transform 0.15s, box-shadow 0.15s;
        }
        
        .note-card:active {
            transform: scale(0.98);
        }
        
        .note-card[data-color="blue"] { border-left-color: #007bff; }
        .note-card[data-color="green"] { border-left-color: #28a745; }
        .note-card[data-color="orange"] { border-left-color: #fd7e14; }
        .note-card[data-color="red"] { border-left-color: #dc3545; }
        .note-card[data-color="purple"] { border-left-color: #6f42c1; }
        
        .note-title {
            font-size: 1.05rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .note-content {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .note-time {
            font-size: 0.75rem;
            color: #999;
            margin-top: 10px;
        }
        
        /* ===== EMPTY STATE ===== */
        .empty-state {
            text-align: center;
            padding: 80px 30px;
        }
        
        .empty-state .icon {
            font-size: 4rem;
            margin-bottom: 16px;
        }
        
        .empty-state p {
            font-size: 1rem;
            color: #999;
        }
        
        /* ===== FAB BUTTON ===== */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: #fff;
            border: none;
            border-radius: 18px;
            font-size: 2rem;
            font-weight: 300;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0,123,255,0.4);
            z-index: 100;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .fab:active {
            transform: scale(0.9);
        }
        
        /* ===== MODAL ===== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            align-items: flex-end;
            justify-content: center;
        }
        
        .modal-overlay.open {
            display: flex;
        }
        
        .modal-box {
            width: 100%;
            max-width: 500px;
            max-height: 85vh;
            background: #fff;
            border-radius: 24px 24px 0 0;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px;
            border-bottom: 1px solid #eee;
            flex-shrink: 0;
        }
        
        .modal-header h2 {
            font-size: 1.15rem;
            font-weight: 600;
            color: #333;
        }
        
        .close-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f5f5f5;
            border: none;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .close-btn:active {
            background: #e8e8e8;
        }
        
        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            -webkit-overflow-scrolling: touch;
        }
        
        .form-group {
            margin-bottom: 18px;
        }
        
        .form-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: #666;
            margin-bottom: 8px;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            background: #f8f8f8;
            border: 2px solid #e8e8e8;
            border-radius: 12px;
            font-size: 1rem;
            color: #333;
            transition: border-color 0.2s, background 0.2s;
        }
        
        .form-input:focus {
            outline: none;
            background: #fff;
            border-color: #007bff;
        }
        
        textarea.form-input {
            min-height: 140px;
            resize: none;
            line-height: 1.6;
            font-family: inherit;
        }
        
        /* ===== COLOR PICKER ===== */
        .color-picker {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .color-option {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 3px solid transparent;
            cursor: pointer;
            transition: transform 0.15s, border-color 0.15s;
        }
        
        .color-option:active {
            transform: scale(0.9);
        }
        
        .color-option.active {
            border-color: #333;
            transform: scale(1.1);
        }
        
        .color-option[data-color="blue"] { background: #007bff; }
        .color-option[data-color="green"] { background: #28a745; }
        .color-option[data-color="orange"] { background: #fd7e14; }
        .color-option[data-color="red"] { background: #dc3545; }
        .color-option[data-color="purple"] { background: #6f42c1; }
        
        /* ===== MODAL FOOTER ===== */
        .modal-footer {
            display: flex;
            gap: 10px;
            padding: 16px 20px;
            border-top: 1px solid #eee;
            flex-shrink: 0;
        }
        
        .btn {
            flex: 1;
            height: 50px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        
        .btn:active {
            opacity: 0.8;
        }
        
        .btn-cancel {
            background: #f0f0f0;
            color: #333;
        }
        
        .btn-save {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: #fff;
        }
        
        .btn-delete {
            flex: 0 0 auto;
            width: 50px;
            background: #fee;
            color: #dc3545;
            font-size: 1.2rem;
        }
        
        /* ===== MENU SIDEBAR ===== */
        .menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 150;
        }
        
        .menu-overlay.open {
            display: block;
        }
        
        .menu-panel {
            position: fixed;
            top: 0;
            right: -300px;
            width: 280px;
            height: 100%;
            background: #fff;
            z-index: 151;
            padding: 24px 20px;
            transition: right 0.3s ease;
            overflow-y: auto;
        }
        
        .menu-panel.open {
            right: 0;
        }
        
        .menu-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #eee;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 16px;
            border-radius: 12px;
            font-size: 1rem;
            color: #333;
            cursor: pointer;
            margin-bottom: 4px;
            transition: background 0.2s;
        }
        
        .menu-item:active {
            background: #f5f5f5;
        }
        
        .menu-item.danger {
            color: #dc3545;
        }
        
        .menu-divider {
            height: 1px;
            background: #eee;
            margin: 12px 0;
        }
        
        .menu-stats {
            margin-top: 24px;
            padding: 16px;
            background: #f8f8f8;
            border-radius: 12px;
            text-align: center;
        }
        
        .menu-stats .label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 6px;
        }
        
        .menu-stats .value {
            font-size: 2rem;
            font-weight: 700;
            color: #007bff;
        }
        
        /* ===== TOAST ===== */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            background: #333;
            color: #fff;
            padding: 14px 28px;
            border-radius: 30px;
            font-size: 0.95rem;
            font-weight: 500;
            z-index: 300;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        /* ===== RESPONSIVE ===== */
        @media (min-width: 501px) {
            .fab {
                right: calc(50% - 220px);
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header>
            <h1>üìù Ghi Ch√∫</h1>
            <div class="header-btns">
                <button class="icon-btn" id="menuBtn" title="Menu">‚ò∞</button>
            </div>
        </header>

        <!-- Search -->
        <div class="search-bar">
            <input type="text" class="search-input" id="searchInput" placeholder="T√¨m ki·∫øm ghi ch√∫...">
        </div>

        <!-- Notes List -->
        <div class="notes-wrapper">
            <div class="notes-list" id="notesList"></div>
        </div>

        <!-- FAB Button -->
        <button class="fab" id="addBtn" title="Th√™m ghi ch√∫">+</button>
    </div>

    <!-- Note Modal -->
    <div class="modal-overlay" id="noteModal">
        <div class="modal-box">
            <div class="modal-header">
                <h2 id="modalTitle">Ghi ch√∫ m·ªõi</h2>
                <button class="close-btn" id="closeModalBtn">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Ti√™u ƒë·ªÅ</label>
                    <input type="text" class="form-input" id="titleInput" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ...">
                </div>
                <div class="form-group">
                    <label class="form-label">N·ªôi dung</label>
                    <textarea class="form-input" id="contentInput" placeholder="Nh·∫≠p n·ªôi dung ghi ch√∫..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">M√†u s·∫Øc</label>
                    <div class="color-picker" id="colorPicker">
                        <div class="color-option active" data-color="blue"></div>
                        <div class="color-option" data-color="green"></div>
                        <div class="color-option" data-color="orange"></div>
                        <div class="color-option" data-color="red"></div>
                        <div class="color-option" data-color="purple"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-delete" id="deleteBtn" style="display:none;">üóëÔ∏è</button>
                <button class="btn btn-cancel" id="cancelBtn">H·ªßy</button>
                <button class="btn btn-save" id="saveBtn">L∆∞u</button>
            </div>
        </div>
    </div>

    <!-- Menu Sidebar -->
    <div class="menu-overlay" id="menuOverlay"></div>
    <div class="menu-panel" id="menuPanel">
        <div class="menu-title">üìã Menu</div>
        <div class="menu-item" id="exportBtn">üì§ Xu·∫•t d·ªØ li·ªáu</div>
        <div class="menu-item" id="importBtn">üì• Nh·∫≠p d·ªØ li·ªáu</div>
        <div class="menu-divider"></div>
        <div class="menu-item danger" id="clearBtn">üóëÔ∏è X√≥a t·∫•t c·∫£</div>
        <div class="menu-stats">
            <div class="label">T·ªïng s·ªë ghi ch√∫</div>
            <div class="value" id="noteCount">0</div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- Hidden file input -->
    <input type="file" id="fileInput" accept=".json" style="display:none;">

    <script>
        (function() {
            // ========== STORAGE ==========
            var STORAGE_KEY = 'my_notes_app_v1';
            var notes = [];
            var editingId = null;
            var selectedColor = 'blue';

            // ========== ELEMENTS ==========
            var notesList = document.getElementById('notesList');
            var noteModal = document.getElementById('noteModal');
            var menuOverlay = document.getElementById('menuOverlay');
            var menuPanel = document.getElementById('menuPanel');
            var searchInput = document.getElementById('searchInput');
            var titleInput = document.getElementById('titleInput');
            var contentInput = document.getElementById('contentInput');
            var modalTitle = document.getElementById('modalTitle');
            var deleteBtn = document.getElementById('deleteBtn');
            var colorPicker = document.getElementById('colorPicker');
            var noteCount = document.getElementById('noteCount');
            var toast = document.getElementById('toast');
            var fileInput = document.getElementById('fileInput');

            // ========== INIT ==========
            function init() {
                loadNotes();
                renderNotes();
                bindEvents();
                registerServiceWorker();
            }

            function loadNotes() {
                try {
                    var saved = localStorage.getItem(STORAGE_KEY);
                    notes = saved ? JSON.parse(saved) : [];
                } catch (e) {
                    notes = [];
                }

                // Default notes
                if (notes.length === 0) {
                    notes = [
                        {
                            id: 1,
                            title: 'Ch√†o m·ª´ng b·∫°n! üëã',
                            content: 'ƒê√¢y l√† ·ª©ng d·ª•ng Ghi Ch√∫ PWA.\n\n‚úì Th√™m ghi ch√∫ m·ªõi b·∫±ng n√∫t +\n‚úì Nh·∫•n v√†o ghi ch√∫ ƒë·ªÉ s·ª≠a\n‚úì T√¨m ki·∫øm nhanh\n‚úì Ch·ªçn m√†u s·∫Øc\n‚úì Xu·∫•t/nh·∫≠p d·ªØ li·ªáu',
                            color: 'blue',
                            date: Date.now()
                        },
                        {
                            id: 2,
                            title: 'C√†i ƒë·∫∑t app l√™n ƒëi·ªán tho·∫°i',
                            content: 'üì± Android (Chrome):\nNh·∫•n ‚ãÆ Menu ‚Üí Th√™m v√†o m√†n h√¨nh ch√≠nh\n\nüçé iPhone (Safari):\nNh·∫•n n√∫t Share ‚Üí Th√™m v√†o MH ch√≠nh',
                            color: 'green',
                            date: Date.now() - 60000
                        }
                    ];
                    saveNotes();
                }
            }

            function saveNotes() {
                try {
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
                } catch (e) {
                    showToast('L·ªói l∆∞u d·ªØ li·ªáu!');
                }
            }

            function registerServiceWorker() {
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.register('sw.js').catch(function() {});
                }
            }

            // ========== RENDER ==========
            function renderNotes() {
                var query = searchInput.value.toLowerCase().trim();
                
                var filtered = notes.filter(function(note) {
                    var titleMatch = note.title.toLowerCase().indexOf(query) !== -1;
                    var contentMatch = note.content.toLowerCase().indexOf(query) !== -1;
                    return titleMatch || contentMatch;
                });

                filtered.sort(function(a, b) {
                    return b.date - a.date;
                });

                noteCount.textContent = notes.length;

                if (filtered.length === 0) {
                    notesList.innerHTML = '<div class="empty-state">' +
                        '<div class="icon">üìù</div>' +
                        '<p>' + (query ? 'Kh√¥ng t√¨m th·∫•y ghi ch√∫' : 'Ch∆∞a c√≥ ghi ch√∫ n√†o') + '</p>' +
                        '</div>';
                    return;
                }

                var html = '';
                for (var i = 0; i < filtered.length; i++) {
                    var note = filtered[i];
                    html += '<div class="note-card" data-id="' + note.id + '" data-color="' + note.color + '">' +
                        '<div class="note-title">' + escapeHtml(note.title) + '</div>' +
                        '<div class="note-content">' + escapeHtml(note.content) + '</div>' +
                        '<div class="note-time">' + formatTime(note.date) + '</div>' +
                        '</div>';
                }
                notesList.innerHTML = html;
            }

            // ========== EVENTS ==========
            function bindEvents() {
                // Add button
                document.getElementById('addBtn').onclick = function() {
                    openModal(null);
                };

                // Close modal
                document.getElementById('closeModalBtn').onclick = closeModal;
                document.getElementById('cancelBtn').onclick = closeModal;

                // Save note
                document.getElementById('saveBtn').onclick = saveNote;

                // Delete note
                deleteBtn.onclick = deleteNote;

                // Menu
                document.getElementById('menuBtn').onclick = openMenu;
                menuOverlay.onclick = closeMenu;

                // Export/Import
                document.getElementById('exportBtn').onclick = exportNotes;
                document.getElementById('importBtn').onclick = function() {
                    fileInput.click();
                };
                document.getElementById('clearBtn').onclick = clearAllNotes;

                // File input
                fileInput.onchange = importNotes;

                // Search
                searchInput.oninput = function() {
                    renderNotes();
                };

                // Click on note card
                notesList.onclick = function(e) {
                    var card = e.target.closest('.note-card');
                    if (card) {
                        var id = parseInt(card.getAttribute('data-id'));
                        openModal(id);
                    }
                };

                // Color picker
                colorPicker.onclick = function(e) {
                    var option = e.target.closest('.color-option');
                    if (option) {
                        var options = colorPicker.querySelectorAll('.color-option');
                        for (var i = 0; i < options.length; i++) {
                            options[i].classList.remove('active');
                        }
                        option.classList.add('active');
                        selectedColor = option.getAttribute('data-color');
                    }
                };

                // Click outside modal
                noteModal.onclick = function(e) {
                    if (e.target === noteModal) {
                        closeModal();
                    }
                };
            }

            // ========== MODAL ==========
            function openModal(id) {
                editingId = id;
                var note = null;

                if (id !== null) {
                    for (var i = 0; i < notes.length; i++) {
                        if (notes[i].id === id) {
                            note = notes[i];
                            break;
                        }
                    }
                }

                modalTitle.textContent = note ? 'Ch·ªânh s·ª≠a ghi ch√∫' : 'Ghi ch√∫ m·ªõi';
                titleInput.value = note ? note.title : '';
                contentInput.value = note ? note.content : '';
                selectedColor = note ? note.color : 'blue';
                deleteBtn.style.display = note ? 'block' : 'none';

                // Update color picker
                var options = colorPicker.querySelectorAll('.color-option');
                for (var i = 0; i < options.length; i++) {
                    var isActive = options[i].getAttribute('data-color') === selectedColor;
                    options[i].classList.toggle('active', isActive);
                }

                noteModal.classList.add('open');
                
                setTimeout(function() {
                    titleInput.focus();
                }, 100);
            }

            function closeModal() {
                noteModal.classList.remove('open');
                editingId = null;
            }

            // ========== CRUD ==========
            function saveNote() {
                var title = titleInput.value.trim();
                var content = contentInput.value.trim();

                if (!title && !content) {
                    showToast('Vui l√≤ng nh·∫≠p n·ªôi dung!');
                    return;
                }

                if (!title) {
                    title = 'Kh√¥ng c√≥ ti√™u ƒë·ªÅ';
                }

                if (editingId !== null) {
                    // Update existing note
                    for (var i = 0; i < notes.length; i++) {
                        if (notes[i].id === editingId) {
                            notes[i].title = title;
                            notes[i].content = content;
                            notes[i].color = selectedColor;
                            notes[i].date = Date.now();
                            break;
                        }
                    }
                    showToast('‚úì ƒê√£ c·∫≠p nh·∫≠t!');
                } else {
                    // Create new note
                    var newNote = {
                        id: Date.now(),
                        title: title,
                        content: content,
                        color: selectedColor,
                        date: Date.now()
                    };
                    notes.unshift(newNote);
                    showToast('‚úì ƒê√£ th√™m ghi ch√∫!');
                }

                saveNotes();
                renderNotes();
                closeModal();
            }

            function deleteNote() {
                if (editingId === null) return;

                if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ghi ch√∫ n√†y?')) {
                    return;
                }

                notes = notes.filter(function(note) {
                    return note.id !== editingId;
                });

                saveNotes();
                renderNotes();
                closeModal();
                showToast('üóëÔ∏è ƒê√£ x√≥a!');
            }

            // ========== MENU ==========
            function openMenu() {
                menuOverlay.classList.add('open');
                menuPanel.classList.add('open');
            }

            function closeMenu() {
                menuOverlay.classList.remove('open');
                menuPanel.classList.remove('open');
            }

            function exportNotes() {
                var dataStr = JSON.stringify(notes, null, 2);
                var blob = new Blob([dataStr], { type: 'application/json' });
                var url = URL.createObjectURL(blob);
                
                var a = document.createElement('a');
                a.href = url;
                a.download = 'ghi-chu-' + formatDate(Date.now()) + '.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                closeMenu();
                showToast('üì§ ƒê√£ xu·∫•t ' + notes.length + ' ghi ch√∫!');
            }

            function importNotes(e) {
                var file = e.target.files[0];
                if (!file) return;

                var reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        var imported = JSON.parse(event.target.result);
                        if (Array.isArray(imported)) {
                            for (var i = 0; i < imported.length; i++) {
                                imported[i].id = Date.now() + i;
                            }
                            notes = notes.concat(imported);
                            saveNotes();
                            renderNotes();
                            showToast('üì• ƒê√£ nh·∫≠p ' + imported.length + ' ghi ch√∫!');
                        } else {
                            showToast('File kh√¥ng h·ª£p l·ªá!');
                        }
                    } catch (err) {
                        showToast('L·ªói ƒë·ªçc file!');
                    }
                };
                reader.readAsText(file);
                
                fileInput.value = '';
                closeMenu();
            }

            function clearAllNotes() {
                if (notes.length === 0) {
                    showToast('Kh√¥ng c√≥ ghi ch√∫ n√†o!');
                    closeMenu();
                    return;
                }

                if (!confirm('X√≥a t·∫•t c·∫£ ' + notes.length + ' ghi ch√∫?')) {
                    return;
                }

                notes = [];
                saveNotes();
                renderNotes();
                closeMenu();
                showToast('üóëÔ∏è ƒê√£ x√≥a t·∫•t c·∫£!');
            }

            // ========== UTILITIES ==========
            function escapeHtml(str) {
                if (!str) return '';
                return String(str)
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#39;');
            }

            function formatTime(timestamp) {
                var now = Date.now();
                var diff = now - timestamp;

                if (diff < 60000) {
                    return 'V·ª´a xong';
                } else if (diff < 3600000) {
                    return Math.floor(diff / 60000) + ' ph√∫t tr∆∞·ªõc';
                } else if (diff < 86400000) {
                    return Math.floor(diff / 3600000) + ' gi·ªù tr∆∞·ªõc';
                } else if (diff < 604800000) {
                    return Math.floor(diff / 86400000) + ' ng√†y tr∆∞·ªõc';
                } else {
                    var d = new Date(timestamp);
                    return d.toLocaleDateString('vi-VN');
                }
            }

            function formatDate(timestamp) {
                var d = new Date(timestamp);
                var year = d.getFullYear();
                var month = ('0' + (d.getMonth() + 1)).slice(-2);
                var day = ('0' + d.getDate()).slice(-2);
                return year + '-' + month + '-' + day;
            }

            function showToast(message) {
                toast.textContent = message;
                toast.classList.add('show');
                
                setTimeout(function() {
                    toast.classList.remove('show');
                }, 2500);
            }

            // ========== START ==========
            init();
        })();
    </script>
</body>
</html>
